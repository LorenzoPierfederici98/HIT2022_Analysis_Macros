<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>HIT 2022 Analysis: /mnt/c/Users/Lorenzo/Desktop/HIT2022_Analysis_Macros/src/AnalyzeTWFragm.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="FOOT_logo.png"/></td>
  <td id="projectalign">
   <div id="projectname">HIT 2022 Analysis
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">AnalyzeTWFragm.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Header file for AnalyzeTWFragm.cc.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;TFile.h&gt;</code><br />
<code>#include &lt;TKey.h&gt;</code><br />
<code>#include &lt;TDirectory.h&gt;</code><br />
<code>#include &lt;TH1.h&gt;</code><br />
<code>#include &lt;TF1.h&gt;</code><br />
<code>#include &lt;TGraphErrors.h&gt;</code><br />
<code>#include &lt;TCanvas.h&gt;</code><br />
<code>#include &lt;TNamed.h&gt;</code><br />
<code>#include &lt;TSpectrum.h&gt;</code><br />
<code>#include &lt;iostream&gt;</code><br />
<code>#include &lt;vector&gt;</code><br />
<code>#include &lt;map&gt;</code><br />
<code>#include &lt;regex&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for AnalyzeTWFragm.h:</div>
<div class="dyncontent">
<div class="center"><img src="AnalyzeTWFragm_8h__incl.png" border="0" usemap="#a_2mnt_2c_2Users_2Lorenzo_2Desktop_2HIT2022__Analysis__Macros_2src_2AnalyzeTWFragm_8h" alt=""/></div>
<map name="a_2mnt_2c_2Users_2Lorenzo_2Desktop_2HIT2022__Analysis__Macros_2src_2AnalyzeTWFragm_8h" id="a_2mnt_2c_2Users_2Lorenzo_2Desktop_2HIT2022__Analysis__Macros_2src_2AnalyzeTWFragm_8h">
<area shape="rect" title="Header file for AnalyzeTWFragm.cc." alt="" coords="549,5,778,60"/>
<area shape="rect" title=" " alt="" coords="5,108,71,133"/>
<area shape="poly" title=" " alt="" coords="549,47,337,72,85,111,84,105,336,66,548,42"/>
<area shape="rect" title=" " alt="" coords="95,108,159,133"/>
<area shape="poly" title=" " alt="" coords="549,51,376,75,173,111,172,105,375,70,548,45"/>
<area shape="rect" title=" " alt="" coords="184,108,284,133"/>
<area shape="poly" title=" " alt="" coords="549,59,298,109,297,104,548,54"/>
<area shape="rect" title=" " alt="" coords="308,108,368,133"/>
<area shape="poly" title=" " alt="" coords="564,63,382,110,381,105,563,58"/>
<area shape="rect" title=" " alt="" coords="393,108,451,133"/>
<area shape="poly" title=" " alt="" coords="591,63,466,107,464,102,589,58"/>
<area shape="rect" title=" " alt="" coords="476,108,595,133"/>
<area shape="poly" title=" " alt="" coords="626,62,565,103,562,98,623,58"/>
<area shape="rect" title=" " alt="" coords="619,108,708,133"/>
<area shape="poly" title=" " alt="" coords="666,60,666,94,661,94,661,60"/>
<area shape="rect" title=" " alt="" coords="732,108,821,133"/>
<area shape="poly" title=" " alt="" coords="700,58,752,97,749,102,696,62"/>
<area shape="rect" title=" " alt="" coords="846,108,950,133"/>
<area shape="poly" title=" " alt="" coords="736,58,855,101,853,106,734,63"/>
<area shape="rect" title=" " alt="" coords="974,108,1054,133"/>
<area shape="poly" title=" " alt="" coords="771,57,961,104,960,109,770,63"/>
<area shape="rect" title=" " alt="" coords="1079,108,1141,133"/>
<area shape="poly" title=" " alt="" coords="779,50,912,74,1065,105,1064,111,911,79,778,56"/>
<area shape="rect" title=" " alt="" coords="1166,108,1217,133"/>
<area shape="poly" title=" " alt="" coords="779,44,952,68,1153,105,1152,111,951,73,778,49"/>
<area shape="rect" title=" " alt="" coords="1241,108,1299,133"/>
<area shape="poly" title=" " alt="" coords="779,42,984,66,1105,83,1228,105,1227,111,1104,89,983,71,778,47"/>
</map>
</div>
</div>
<p><a href="AnalyzeTWFragm_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aabad4b700eccd2608a76d82430bfea3a" id="r_aabad4b700eccd2608a76d82430bfea3a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="AnalyzeTWFragm_8h.html#aabad4b700eccd2608a76d82430bfea3a">SumNentries</a> (TFile *file)</td></tr>
<tr class="memdesc:aabad4b700eccd2608a76d82430bfea3a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sums the number of entries in a ROOT file.  <br /></td></tr>
<tr class="separator:aabad4b700eccd2608a76d82430bfea3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c75f7227727efc6541cf19ea6fec148" id="r_a6c75f7227727efc6541cf19ea6fec148"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="AnalyzeTWFragm_8h.html#a6c75f7227727efc6541cf19ea6fec148">FitHistogramsInDirectory</a> (TDirectory *dir, double threshold, double energy, std::map&lt; TString, std::map&lt; int, double &gt; &gt; &amp;fitMeansP, std::map&lt; TString, std::map&lt; int, double &gt; &gt; &amp;fitErrorsP, std::map&lt; TString, std::map&lt; int, double &gt; &gt; &amp;fitMeansHe, std::map&lt; TString, std::map&lt; int, double &gt; &gt; &amp;fitErrorsHe, TFile *outputFile)</td></tr>
<tr class="memdesc:a6c75f7227727efc6541cf19ea6fec148"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fits histograms in a directory and stores the results.  <br /></td></tr>
<tr class="separator:a6c75f7227727efc6541cf19ea6fec148"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb0f053729deb39169a04ad7965ed097" id="r_abb0f053729deb39169a04ad7965ed097"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="AnalyzeTWFragm_8h.html#abb0f053729deb39169a04ad7965ed097">ProcessFile</a> (const std::string &amp;fileName, double energy, std::map&lt; TString, std::map&lt; int, double &gt; &gt; &amp;fitMeansP, std::map&lt; TString, std::map&lt; int, double &gt; &gt; &amp;fitMeansHe, std::map&lt; TString, std::map&lt; int, double &gt; &gt; &amp;fitErrorsP, std::map&lt; TString, std::map&lt; int, double &gt; &gt; &amp;fitErrorsHe)</td></tr>
<tr class="memdesc:abb0f053729deb39169a04ad7965ed097"><td class="mdescLeft">&#160;</td><td class="mdescRight">Processes a ROOT file and fits the histograms.  <br /></td></tr>
<tr class="separator:abb0f053729deb39169a04ad7965ed097"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14f0293f4852a5be3aa203d1aedcf64c" id="r_a14f0293f4852a5be3aa203d1aedcf64c"><td class="memItemLeft" align="right" valign="top">std::pair&lt; TFitResultPtr, TFitResultPtr &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="AnalyzeTWFragm_8h.html#a14f0293f4852a5be3aa203d1aedcf64c">FitPeaksWithTSpectrum</a> (TH1D *hist, double energy, const TString &amp;layerBarCombination)</td></tr>
<tr class="memdesc:a14f0293f4852a5be3aa203d1aedcf64c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fits peaks in a histogram using TSpectrum.  <br /></td></tr>
<tr class="separator:a14f0293f4852a5be3aa203d1aedcf64c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Header file for AnalyzeTWFragm.cc. </p>
<p>This file contains function declarations for fitting charge distributions from the AnalyzeTWChargeTime.cc merged output files (for fragmentation runs). A fit is performed with 2 separate gaussians, one for proton and one for helium peaks. The fit limits for the proton peaks depend on the beam energy. Only the histograms whose entries are greater than a fraction of the sum of the merged files total event number are fitted (the entries of each file part of the merged output are saved in it and summed). The histogram peaks are automatically found with TSPectrum; the fits are then performed within a certain bin-range centered around the peak, depending on the specific bar and beam energy. The fit results are stored in files named like e.g. AnaFOOT_TW_Decoded_HIT2022_140MeV_Fit.root (created if they don't already exist, or overwritten if they do), inside of the ChargeFit directory. To be run with root -l -b -q 'AnalyzeTWFragm.cc()'. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a6c75f7227727efc6541cf19ea6fec148" name="a6c75f7227727efc6541cf19ea6fec148"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c75f7227727efc6541cf19ea6fec148">&#9670;&#160;</a></span>FitHistogramsInDirectory()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FitHistogramsInDirectory </td>
          <td>(</td>
          <td class="paramtype">TDirectory *&#160;</td>
          <td class="paramname"><em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>threshold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>energy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::map&lt; TString, std::map&lt; int, double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>fitMeansP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::map&lt; TString, std::map&lt; int, double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>fitErrorsP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::map&lt; TString, std::map&lt; int, double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>fitMeansHe</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::map&lt; TString, std::map&lt; int, double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>fitErrorsHe</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TFile *&#160;</td>
          <td class="paramname"><em>outputFile</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fits histograms in a directory and stores the results. </p>
<p>This function fits the histograms in the specified directory using two separate Gaussian functions, one for proton peaks and one for helium peaks. The fit limits depend on the bar and beam energy. Only histograms with entries greater than a specified threshold are fitted. The fit results are stored in the provided maps.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dir</td><td>Pointer to the directory containing the histograms. </td></tr>
    <tr><td class="paramname">threshold</td><td>Minimum number of entries required to fit a histogram. </td></tr>
    <tr><td class="paramname">energy</td><td>Beam energy. </td></tr>
    <tr><td class="paramname">fitMeansP</td><td>Map to store the mean values of the proton fits. </td></tr>
    <tr><td class="paramname">fitErrorsP</td><td>Map to store the errors of the proton fits. </td></tr>
    <tr><td class="paramname">fitMeansHe</td><td>Map to store the mean values of the helium fits. </td></tr>
    <tr><td class="paramname">fitErrorsHe</td><td>Map to store the errors of the helium fits. </td></tr>
    <tr><td class="paramname">outputFile</td><td>Pointer to the output ROOT file to store the fitted histograms. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a14f0293f4852a5be3aa203d1aedcf64c" name="a14f0293f4852a5be3aa203d1aedcf64c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14f0293f4852a5be3aa203d1aedcf64c">&#9670;&#160;</a></span>FitPeaksWithTSpectrum()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::pair&lt; TFitResultPtr, TFitResultPtr &gt; FitPeaksWithTSpectrum </td>
          <td>(</td>
          <td class="paramtype">TH1D *&#160;</td>
          <td class="paramname"><em>hist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>energy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TString &amp;&#160;</td>
          <td class="paramname"><em>layerBarCombination</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fits peaks in a histogram using TSpectrum. </p>
<p>This function fits two peaks in the specified histogram using TSpectrum. The peaks are fitted with Gaussian functions, and the fit results are returned.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">hist</td><td>Pointer to the histogram. </td></tr>
    <tr><td class="paramname">energy</td><td>Beam energy. </td></tr>
    <tr><td class="paramname">layerBarCombination</td><td>String representing the layer and bar combination. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Pair of fit results for the proton and helium peaks. </dd></dl>

</div>
</div>
<a id="abb0f053729deb39169a04ad7965ed097" name="abb0f053729deb39169a04ad7965ed097"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb0f053729deb39169a04ad7965ed097">&#9670;&#160;</a></span>ProcessFile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProcessFile </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>fileName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>energy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::map&lt; TString, std::map&lt; int, double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>fitMeansP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::map&lt; TString, std::map&lt; int, double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>fitMeansHe</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::map&lt; TString, std::map&lt; int, double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>fitErrorsP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::map&lt; TString, std::map&lt; int, double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>fitErrorsHe</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Processes a ROOT file and fits the histograms. </p>
<p>This function processes the specified ROOT file, sums the number of entries, calculates the threshold, and fits the histograms in the specified directories. The fit results are stored in the provided maps.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fileName</td><td>Name of the ROOT file. </td></tr>
    <tr><td class="paramname">energy</td><td>Beam energy. </td></tr>
    <tr><td class="paramname">fitMeansP</td><td>Map to store the mean values of the proton fits. </td></tr>
    <tr><td class="paramname">fitMeansHe</td><td>Map to store the mean values of the helium fits. </td></tr>
    <tr><td class="paramname">fitErrorsP</td><td>Map to store the errors of the proton fits. </td></tr>
    <tr><td class="paramname">fitErrorsHe</td><td>Map to store the errors of the helium fits. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aabad4b700eccd2608a76d82430bfea3a" name="aabad4b700eccd2608a76d82430bfea3a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aabad4b700eccd2608a76d82430bfea3a">&#9670;&#160;</a></span>SumNentries()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int SumNentries </td>
          <td>(</td>
          <td class="paramtype">TFile *&#160;</td>
          <td class="paramname"><em>file</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sums the number of entries in a ROOT file. </p>
<p>This function iterates over the keys in the provided ROOT file and sums the entries of objects whose names match the pattern "nentries_run_\\d+".</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">file</td><td>Pointer to the ROOT file. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Total number of entries. </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
